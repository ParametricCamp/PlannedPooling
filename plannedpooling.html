<html>

<head>


    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
        <script type="text/javascript" src="/jscolor/jscolor.js"></script>
        <script src="http://d3js.org/d3.v3.min.js"></script>



<meta name="description" content="This page describes the the site Planned/Intentional Pooling, covers how you can help, and my plans for the future." />


<style type="text/css">

#page { margin:0px 10px 10px 10px; width: 40em;}


.topbar a:link    {color: #b0c4de; background: 555555}
.topbar a:visited {color: #b0c4de;  background: 555555}
.topbar a:active  {color: #b0c4de;    background: 555555}
.topbar {margin-left:10px; }
.byme {text-align:right; font-size:60%; }

#navigation {border:0px; width:100%; border-spacing:0px; padding:0px; background-color:#000000; width:100%; font-color:#b0c4de; font-family:arial; size:large}


body {margin:0px;background-color:#ffffff; }

#long {width:100%}

.titlebar { border:0px; width:100%; border-spacing:0px; padding:0px; background-color:#BF5FFF; text-align:right; margin-right:10px; font-family:impact; font-size:x-large;}  
.titlebar a:link {color:555555;  background: BF5FFF}
.titlebar a:visited {color:555555;  background: BF5FFF}

</style>

<title>
About: Planned/Intentional Pooling
</title>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24743467-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</head>

<body>


<table class="titlebar"><tr><td>
Planned Pooling
<!--      <div class="byme">
        by <a href="http://www.learnfromdata.com/aboutme/">David Chudzicki</a>
      </div>
-->
</td> </tr> 

</table>

<table id="navigation">
  <tr>
    <td>
      <div class="topbar">
      <a href="/">the app</a>
      &nbsp;&nbsp; &nbsp;&nbsp; 
      <a href="/about/">about</a>
      &nbsp;&nbsp; &nbsp;&nbsp; 
      <a href="/examples/">examples</a>
      </div>
    </td>
  </tr>
</table>

<div id="page">






<a href="javascript: adjustNumStitchesRow(-5)">&lArr; 5 Stitches Shorter </a> &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
<a href="javascript: adjustNumStitchesRow(-1)">&larr; 1 Stitch Shorter </a> |
<a href="javascript: adjustNumStitchesRow(1)"> 1 Stitch Longer &rarr;</a> &nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;
<a href="javascript: adjustNumStitchesRow(5)"> 5 Stitches Longer &rArr;</a>

<table>
    <tr>
        <td>
            <div class="fieldWrapper">
                <label for="id_stitches">Stitches in a row</label>:
                <input type="text" value="12" id="numStitchesRow" />
            </div>
        </td>
    </tr>
    <tr id="trColor1">
        <td>
            <div>
                <label>Color 1</label>:
                <input id="color1" type="color {pickerPosition:&#39;right&#39;}" class="color {pickerPosition:&#39;right&#39;}" value="5DF4B6" />
            </div>
        </td>
        <td>
            <div>
                <label>Stitches in color 1</label>:
                <input type="text" value="2" id="numStitches1" />
            </div>
        </td>
    </tr>
    <tr id="trColor2">
        <td>
            <div>
                <label>Color 2</label>:
                <input id="color2" type="color {pickerPosition:&#39;right&#39;}" class="color {pickerPosition:&#39;right&#39;}" value="F4D2C3" />
            </div>
        </td>
        <td>
            <div>
                <label>Stitches in color 2</label>:
                <input type="text" value="5" id="numStitches2" />
            </div>
        </td>
    </tr>
    <tr><td><button onclick="addAColor();">Add a color</button>
    <button id="removeAColor" onclick="removeAColor();">Remove a color</button></td></tr>
    <tr>
        <td>
            <div>
                <label>Type of knitting:</label>:
                <select id="typeOfKnitting">
                    <option value="flat" selected="selected">Flat (back and forth) knitting</option>
                    <option value="circular">Circular (in the round) knitting</option>
                </select>
            </div>
        </td>
    </tr>
</table>

<div id="canvasDiv"></div>

<p>If you want to save your picture, you can take a screenshot. (If you don't know how, search the web for how to take a screenshot in your operating system.) </p>

<p>If you take a screenshot before doing your knitting, I'd love to see the screenshot along with the picture of your knitting to compare the predictions with how it turned out. You can send me email: plannedpooling@gmail.com.</p>

<script>

function adjustNumStitchesRow(n) {
    $("#numStitchesRow").val(parseInt($("#numStitchesRow").val()) + n);
    draw();
}

function chunkArray(array, chunk) {
    var i,j;
    var chunkList = [];
    for (i=0,j=array.length; i<j; i+=chunk) {
        chunkList.push(array.slice(i,i+chunk));
    }
    return chunkList;
}

function backAndForthIfy(array, rowLength) {
    var chunkList = chunkArray(array, rowLength);
    var newChunkList = d3.range(chunkList.length).map(function(i) {
        if (i % 2 == 0) {return chunkList[i];}
        else {return chunkList[i].reverse();}
    })
    return [].concat.apply([], newChunkList);
}




function rep(arr, count) {
    var ln = arr.length;
    var b = new Array();
    for (i = 0; i < count; i++) {
        b.push(arr[i % ln]);
    }

    return b;
}

//http://stackoverflow.com/questions/6798715/create-a-square-of-colors-with-jquery-or-javascript
function draw() {
    $(".drawing").remove()

    var bigWidthInPixels = 500;
    var unitsWide = parseInt($("#numStitchesRow").val());
    var unitsTall = unitsWide;

    var totalSize = unitsWide * unitsTall;

    var colorChoices = d3.range(1,nColors+1).map(function(i) {return "#" + $("#color"+i).val();})
    var numStitchesChoices = d3.range(1,nColors+1).map(function(i) {return parseInt($("#numStitches" + i).val());})

    var colorsList = d3.range(nColors).map(function(i) {return rep([colorChoices[i]], numStitchesChoices[i]);});
    var colors = rep([].concat.apply([], colorsList), totalSize);
    
    if ($("#typeOfKnitting").val() == "flat") {
        colors = backAndForthIfy(colors, unitsWide);
    }


    makeRectanglesCanvas(colors, unitsWide, unitsTall, bigWidthInPixels);
};

function makeRectanglesCanvas(colors, unitsWide, unitsTall, bigWidthInPixels) {
    var unitSizeInPixels = bigWidthInPixels/unitsWide;
    var canvas = document.createElement('canvas');
    canvas.id = "canvas";
    canvas.width = bigWidthInPixels;
    canvas.height = bigWidthInPixels;
    $("#canvasDiv").append(canvas);
    var ctx = $("#canvas")[0].getContext('2d');

    var colors2d = chunkArray(colors, unitsWide);

    for (var i=0; i<unitsTall; i++){
      for (var j=0; j<unitsWide; j++){
        ctx.fillStyle = colors2d[i][j];
        ctx.strokeStyle = colors2d[i][j];

        ctx.fillRect( j*unitSizeInPixels, i*unitSizeInPixels, unitSizeInPixels + .5, unitSizeInPixels + .5);
      }
    }
}

function removeAColor() {
    $("#trColor" + nColors).remove();
    nColors -= 1;
    draw();
    if (nColors==1) $("#removeAColor").removeAttr('href');
}

function addAColor() {
    nColors += 1;
    $( "#trColor" + (nColors-1) ).after( ' \
    <tr id="trColor' + nColors + '">\
        <td>\
            <div>\
                <label>Color ' + nColors + '</label>:\
                <input id="color' + nColors + '" type="color {pickerPosition:&#39;right&#39;}" class="color {pickerPosition:&#39;right&#39;}" value="F4D2C3" />\
            </div>\
        </td>\
        <td>\
            <div>\
                <label>Stitches in color ' + nColors + '</label>:\
                <input type="text" value="5" id="numStitches' + nColors + '" />\
            </div>\
        </td>\
    </tr>\
        ' );
    var col = new jscolor.color($("#color" + nColors)[0]);
    draw();
    $("#removeAColor").attr("href", "javascript: removeAColor()")
    $('input').change(draw);

}

var nColors = 2;

$( document ).ready(draw);
$('input').change(draw);
$('select').change(draw);


</script>

</body>
</html>
